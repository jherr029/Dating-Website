<!DOCTYPE html>
<html lang="en">
<head>
  <style>
       #map {
        height: 400px;
        width: 400px; 
        margin-left:auto; 
        margin-right:auto;
       }

    </style>

<script> 
  function GetEvents(){
  var eid = "PYCJZ3SM0KUWKRBPYOjzyQpwFZs1";
  var date = "";
  var description = "";
  var location = "";
  var name = "";
  var dates = [];
  var descriptions = [];
  var locations = [];
  var names = [];
  var events = [];
  const fb = firebase.database().ref().child('Events');
  fb.once("value")
  .then(function(snapshot){
      snapshot.forEach(function(childSnapshot){
        date = childSnapshot.child('eventDate').val();
        description = childSnapshot.child('eventDescription').val();
        location = childSnapshot.child('eventLocation').val();
        name = childSnapshot.child('eventName').val();
        dates.push(date);
        descriptions.push(description);
        locations.push(location);
        names.push(name);
        
    });
    events.push(names);
    events.push(dates);
    events.push(locations);
    events.push(descriptions);


    ListEvents.apply(this, events);
    
  });

}


function ListEvents(...events)
{
  for(i = 0; i < events.length; i++)
    {
      for(j = 0; j < events[i].length; j++)
      {
        console.log(events[i][j]);
      }
    }
  var fullurl = window.location.href;
  var arrnum = fullurl.slice(fullurl.indexOf("?arrnum="+4), fullurl.length);
  var maxSize = events[0].length;
  PrintEvents(events[0][arrnum], events[1][arrnum], events[2][arrnum], events[3][arrnum]);


}


function PrintEvents(n, da, l, de)
{
  document.getElementById("name").innerHTML = n;
  document.getElementById("date").innerHTML = da;
  document.getElementById("location").innerHTML = l;
  document.getElementById("description").innerHTML = de;
  document.getElementById("location-input").value = l;

}

function prevEvent(){
  var fullurl = window.location.href;
  var arrnum = fullurl.slice(fullurl.indexOf("?arrnum="+4), fullurl.length);
  if(arrnum > 0)
  {
      arrnum--;
  }
  window.location.href = 'file:///C:/Users/tariq/Desktop/final_PleaseDateMe%20(3)/final_PleaseDateMe/resources/html/viewEvent.html?arrnum=' + arrnum;
}

function nextEvent(){
  var count = 0;
  const fb = firebase.database().ref().child('Events');
  fb.once("value")
  .then(function(snapshot){
      snapshot.forEach(function(childSnapshot){
        count++;
      });



      var fullurl = window.location.href;
      var arrnum = fullurl.slice(fullurl.indexOf("?arrnum="+4), fullurl.length);
      if(arrnum < (count-1))
      {
          arrnum++;
      }
      window.location.href = 'file:///C:/Users/tariq/Desktop/final_PleaseDateMe%20(3)/final_PleaseDateMe/resources/html/viewEvent.html?arrnum=' + arrnum;
    });
}

</script>


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <title>My Geocode App</title>

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-rc.4/angular.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.0/css/bulma.min.css">

    <link rel="stylesheet" href="../css/style.css">
    
    
  <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
    apiKey: "AIzaSyBzP583ZXMjs_BKk1Kxnw9qHrtaZ7jq8Jg",
    authDomain: "test-project-7b02a.firebaseapp.com",
    databaseURL: "https://test-project-7b02a.firebaseio.com",
    projectId: "test-project-7b02a",
    storageBucket: "test-project-7b02a.appspot.com",
    messagingSenderId: "916154302194"
    };
    firebase.initializeApp(config);
  </script>
    
    <script src="app.js"></script>
</head>

<body class="grayBg">
  <script>GetEvents()</script>
  <section>
    <div class="hero">
        <nav class="navbar topNav">
          <div class="container">
          <div class="navbar-brand">
          
            <a href="" class="navbar-item pinkText">
              PlsDate
            </a>

            <span class="navbar-burger burger" onclick="document.querySelector('.navbar-menu').classList.toggle('is-active');" data-target="navbarMenuHeroC">
            <span></span>
            <span></span> 
            <span></span>
          </span>
          </div>

          <div id="navbarMenuHeroC" class="navbar-menu">
            <div class="navbar-end">
              <a href="profile.html" class="navbar-item pinkText">
                Settings
              </a> 
              <div class="navbar-end">
              <a href="index.html" class="navbar-item pinkText">
                Logout
              </a> 
              
            </div>
          </div>
        </div>
        </nav>
    </div>
  </section>

  <section>
    <div class="hero is-bold is-danger">
      <div class="hero-body">
        <div class="container">
          <h1 class="title">Events</h1>
          <h2 class="subtitle">Enjoy yourself at some events!</h2>
        </div>
      </div>

      <div class="hero-foot">
          <nav class="tabs is-boxed">
            <div class="container">
              <ul>
                <li><a href="matches.html">Home</a></li>
                <li><a href="messages.html">Messages</a></li>
                 <li><a href="makeEvent.html">Make an Event</a></li>
                 <li class="is-active"><a href = "viewEvent.html">View Events</a></li>
              </ul>
            </div>
          </nav>
        </div>

    </div>
  </section>

<!--printing out event info-->
  <section class="grayBg">
      <br>
      <div class="container">
          <div class="box">
              <div class="card">
        
                  <div class="card-content">
                    
                      <div class="media-content">
                        <p id="name" class="title is-4"></p><br/>
                        <p id="date" class="subtitle is-6"></p>
                        <p id="location" class="subtitle is-6"></p>
                        <p id="description" class="subtitle is-6"></p>
                      </div>
                    </div>
                
                    <div class="content">
                      
                      
                      <br>
                      
                    </div>
                  </div>
                </div>
          </div>
      </div>
      <br/>
        <center>
      <a onclick = "prevEvent()" id = "previous" class="button is-danger">Previous</a>
    <a onclick= "nextEvent()" id = "next" class="button is-danger">Next</a>

<br/>
<br/>

  <div class="container">
    
    <form id="location-form">
      <input type="text" id="location-input" class="form-control form-control-lg" placeholder = "Enter Location">

      <br>
      <button type="submit" class="btn btn-primary btn-block">Find on Map</button>
    </form>
    <div class="card-block" id="formatted-address"></div>
    <div class="card-block" id="address-components"></div>
    <div class="card-block" id="geometry"></div>
  </div>
  <div id="map"></div>
  <script>
    // Call Geocode
    //geocode();

    // Get location form
    var locationForm = document.getElementById('location-form');

    // Listen for submiot
    locationForm.addEventListener('submit', geocode);

    function geocode(e){
      // Prevent actual submit
      e.preventDefault();

      var location = document.getElementById('location-input').value;

      axios.get('https://maps.googleapis.com/maps/api/geocode/json',{
        params:{
          address:location,
          key:'AIzaSyA3PwxFMqLh1znNj56ZTE0nxPdZMxs7SnQ'
        }
      })
      .then(function(response){
        // Log full response
        console.log(response);

        // Formatted Address
        var formattedAddress = response.data.results[0].formatted_address;
        var formattedAddressOutput = `
          <ul class="list-group">
            <li class="list-group-item">${formattedAddress}</li>
          </ul>
        `;

        // Address Components
        var addressComponents = response.data.results[0].address_components;
        var addressComponentsOutput = '<ul class="list-group">';
        for(var i = 0;i < addressComponents.length;i++){
          addressComponentsOutput += `
            <li class="list-group-item"><strong>${addressComponents[i].types[0]}</strong>: ${addressComponents[i].long_name}</li>
          `;
        }
        addressComponentsOutput += '</ul>';

        // Geometry
        var lat = response.data.results[0].geometry.location.lat;
        var lng = response.data.results[0].geometry.location.lng;
        var geometryOutput = `
          <ul class="list-group">
            <li class="list-group-item"><strong>Latitude</strong>: ${lat}</li>
            <li class="list-group-item"><strong>Longitude</strong>: ${lng}</li>
          </ul>
        `;

        // Output to app
      // document.getElementById('formatted-address').innerHTML = formattedAddressOutput;
      //  document.getElementById('address-components').innerHTML = addressComponentsOutput;
     //   document.getElementById('geometry').innerHTML = geometryOutput;
    //  })
    //  .catch(function(error){
    //    console.log(error);
      });
    }

    function initMap() {
        var uluru = {lat: -25.363, lng: 131.044};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 4,
          center: uluru
        });
        var marker = new google.maps.Marker({
          position: uluru,
          map: map
        });
      }
  </script>


    
     
   
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3PwxFMqLh1znNj56ZTE0nxPdZMxs7SnQ&callback=initMap">
    </script>


</body>
</html>
